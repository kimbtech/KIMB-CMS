function inline2Blob(inline){var byte;if(inline.split(',')[0].indexOf('base64')>=0){byte=atob(inline.split(',')[1])}
else{byte=unescape(inline.split(',')[1])}
var mime=inline.split(',')[0].split(':')[1].split(';')[0];var array=new Uint8Array(byte.length);for(var i=0;i<byte.length;i++){array[i]=byte.charCodeAt(i)}
return new Blob([array],{type:mime})}
function encrypt(){var link=window.location+"&raw";$("img").css("visibility","visible");$.get(link,function(data){if(data!=""){var pass=$("input#pass").val();try{var file=sjcl.decrypt(pass,data);saveAs(inline2Blob(file),filename);$("img").css("visibility","hidden")}
catch(e){$("img").css("visibility","hidden");alert('Konnte die Datei nicht entschlÃ¼sseln:\r\n('+e.message+')')}}
else{alert("Fehler beim Laden der Datei!")}})}
$(function(){$("input#pass").keyup(function(event){if(event.keyCode==13){encrypt()}});$("button#dec").click(encrypt)})
