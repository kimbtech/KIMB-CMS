function savesubmit(){
	var cont = $( "textarea#cont" ).val();
	var name = $( "input#name" ).val();
	var mail = $( "input#mail" ).val();
	
	localStorage.setItem( 'name' , name );
	localStorage.setItem( 'mail' , mail );
	localStorage.setItem( 'cont' , cont );
	
	return true;
}
function loadsumbit(){
	var name = localStorage.getItem( 'name' );
	var mail = localStorage.getItem( 'mail' );
	var cont = localStorage.getItem( 'cont' );
	
	$( "textarea#cont" ).val( cont );
	$( "input#name" ).val( name );
	$( "input#mail" ).val( mail );
	
	return true;
}
function delsubmit(){
	localStorage.removeItem( 'name' );
	localStorage.removeItem( 'mail' );
	localStorage.removeItem( 'cont' );
	
	 return true;
}

function add( place ){

	if( place == 'new'){
		var loadto = 'div#guestadd';
	}
	else{
		var loadto = 'div#answer_' + place +'_add' ;
	}
		
	$.get( siteurl + "/ajax.php?addon=guestbook&loadadd&pl=" + place )
	 	.done(function( data ) {
			$( loadto ).html( data );
			
			loadsumbit();
		})
		.fail(function() {
			$( loadto ).html( "Laden des Formulars nicht möglich!" );
		});
		
	if( place == 'new'){
		$( loadto ).css( "display" , "block" );
		
		$( "button#guestbuttdis" ).css( "display" , "block" );
		$( "button#guestbuttadd" ).css( "display" , "none" );
	}
}
function dis(){
	$( "div#guestadd" ).css( "display" , "none" );
	$( "button#guestbuttdis" ).css( "display" , "none" );
	$( "button#guestbuttadd" ).css( "display" , "block" );
}
function preview( id ){
	var cont = $( "textarea.cont_" + id ).val();
	var name = $( "input.name_" + id ).val();
	
	if( cont == '' || name == '' ){
		$( "div#prew_" + id ).html( "Bitte geben Sie einen Namen und einen Inhalt an!" );
	}
	else{	
		$.post( siteurl + "/ajax.php?addon=guestbook", { "vorschau_name": name, "vorschau_cont": cont } )
	 		.done(function( data ) {
				$( "div#prew_" + id ).html( data );
	  		})
			.fail(function() {
				$( "div#prew_" + id ).html( "Fehlerhafte AJAX Abfrage" );
			});
	}
		
	$( "div#prewarea_" + id ).css( "display" , "block" );

	savesubmit();

	return false;
}

function answer( id, file = 'none' ){
	
	if( file != 'none' ){
		loadto =  'div#answer_' + id +'_dis' ;
		
		$.get( siteurl + "/ajax.php?addon=guestbook&answer&id=" + id + "&siteid=" + siteid )
	 	.done(function( data ) {
			$( loadto ).html( data );
			
			loadsumbit();
		})
		.fail(function() {
			$( loadto ).html( "Laden der Antworten nicht möglich!" );
		});
	}
	
	add( id );
	
	$( "div.answer_" + id ).css( "display", "block" );
	
	return true;
}
